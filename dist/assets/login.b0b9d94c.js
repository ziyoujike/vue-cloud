import{g as d,A as z,_ as N,d as V,a as g,C as R,c as w,o as r,e as v,w as l,i as F,x as S,h as C,t as q,D as P,m as A,S as j,G as H,H as T,u as G,b as M,f as I,B as $,I as K,l as B,R as J,L as Q}from"./index.5f0281f2.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},X=W;function L(i){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?Object(arguments[o]):{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),s.forEach(function(t){Y(i,t,n[t])})}return i}function Y(i,o,n){return o in i?Object.defineProperty(i,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[o]=n,i}var D=function(o,n){var s=L({},o,n.attrs);return d(z,L({},s,{icon:X}),null)};D.displayName="LockOutlined";D.inheritAttrs=!1;var Z=D;const ee=C("\u83B7\u53D6\u9A8C\u8BC1\u7801"),te=C("\u83B7\u53D6\u4E2D"),ae=V({__name:"code-input",props:{account:{type:String,default:""},type:{type:String,default:"sendPhone"},accountName:{type:String,default:"phone"}},emits:["update:value","enter","success"],setup(i,{expose:o,emit:n}){const s=i,t={sendPhone:j},_=g(""),a=g("init"),u=g(0);let p=g(!1),b,x=()=>{n("update:value",_.value)};const O=async()=>{try{p.value=!0;let f={};f[s.accountName]=s.account;let m=await t[s.type](f);p.value=!1,n("success",f),A.success(m.message),a.value="countDown",e()}catch{a.value="init",p.value=!1}},h=()=>{if(a.value==="init"){if(!s.account)return A.error("\u624B\u673A\u53F7\u4E0D\u6B63\u786E");a.value="loading",O()}},e=()=>{u.value=60,b=setInterval(()=>{if(u.value--,u.value<=0){y();return}},1e3)},y=()=>{b&&clearInterval(b),a.value="init"};return R(()=>{y()}),o({reset:()=>{y(),_.value="",n("update:value",_.value)}}),(f,m)=>{const c=w("a-button"),U=w("a-input");return r(),v("div",null,[d(U,{value:_.value,"onUpdate:value":m[0]||(m[0]=E=>_.value=E),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",autocomplete:"off",class:"line-height-36",onChange:F(x),onKeydown:m[1]||(m[1]=P(E=>n("enter"),["enter"]))},{suffix:l(()=>[d(c,{class:"suffix-autoCode blue-color font-size-12",size:"small",loading:F(p),onClick:h},{default:l(()=>[a.value=="init"?(r(),v(S,{key:0},[ee],64)):a.value=="loading"?(r(),v(S,{key:1},[te],64)):(r(),v(S,{key:2},[C(q(u.value)+"s\u91CD\u65B0\u83B7\u53D6",1)],64))]),_:1},8,["loading"])]),_:1},8,["value","onChange"])])}}});var ne=N(ae,[["__scopeId","data-v-977067e8"]]);const oe={class:"login-container"},ue={class:"form-wrap"},re=C("\u5BC6\u7801\u767B\u5F55"),se=C("\u624B\u673A\u53F7\u9A8C\u8BC1\u767B\u5F55"),le=C("\u6CE8\u518C\u5E76\u767B\u5F55"),ie={class:"bottom-text flex-s-b"},ce=V({__name:"login",setup(i){const o=H(),n=T(),s=G(),t=g("password"),_=g(),a=g(!1),u=M({password:"",phone:"",phone_code:""}),p=()=>{_.value.validate().then(()=>{t.value==="register"&&b(),t.value!=="register"&&x()}).catch(()=>{console.log("error")})},b=async()=>{try{a.value=!0,await J(u),a.value=!1,x()}catch{a.value=!1}},x=async()=>{try{a.value=!0;let h=await Q(u);s.SET_ISLOGIN(!0),await s.GET_USER_INFO(),a.value=!1,A.success(h.message);let e=o.query.redirect?o.query.redirect:"/";e=e=="/404"?"/":e,n.push(`${e}`)}catch{a.value=!1}},O={phone:{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7!"},password:{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801!"},phone_code:{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801!"}};return(h,e)=>{const y=w("a-input"),k=w("a-form-item"),f=w("a-button"),m=w("a-form");return r(),v("div",oe,[I("div",ue,[d(m,{ref_key:"formRef",ref:_,model:u,rules:O},{default:l(()=>[d(k,{name:"phone"},{default:l(()=>[d(y,{class:"line-height-36",value:u.phone,"onUpdate:value":e[0]||(e[0]=c=>u.phone=c),placeholder:"\u624B\u673A\u53F7"},{prefix:l(()=>[d(F(K),{style:{color:"#889aa4"}})]),_:1},8,["value"])]),_:1}),t.value==="password"?(r(),B(k,{key:0,name:"password"},{default:l(()=>[d(y,{class:"line-height-36",value:u.password,"onUpdate:value":e[1]||(e[1]=c=>u.password=c),type:"password",placeholder:"\u5BC6\u7801",onKeydown:P(p,["enter"])},{prefix:l(()=>[d(F(Z),{style:{color:"#889aa4"}})]),_:1},8,["value","onKeydown"])]),_:1})):(r(),B(k,{key:1,name:"phone_code"},{default:l(()=>[d(ne,{value:u.phone_code,"onUpdate:value":e[2]||(e[2]=c=>u.phone_code=c),account:u.phone,onEnter:p},null,8,["value","account"])]),_:1})),d(k,null,{default:l(()=>[t.value==="password"?(r(),B(f,{key:0,class:"btn-height-36",loading:a.value,type:"primary",onClick:p},{default:l(()=>[re]),_:1},8,["loading"])):t.value==="phone"?(r(),B(f,{key:1,class:"btn-height-36",loading:a.value,type:"primary",onClick:p},{default:l(()=>[se]),_:1},8,["loading"])):(r(),B(f,{key:2,class:"btn-height-36",loading:a.value,type:"primary",onClick:p},{default:l(()=>[le]),_:1},8,["loading"]))]),_:1})]),_:1},8,["model"]),I("div",ie,[t.value==="register"?(r(),v("a",{key:0,onClick:e[3]||(e[3]=c=>t.value="password")},"\u8FD4\u56DE\u767B\u5F55")):(r(),v("a",{key:1,onClick:e[4]||(e[4]=c=>t.value="register")},"\u6CA1\u6709\u8D26\u53F7\uFF1F\u7ACB\u5373\u6CE8\u518C")),t.value==="phone"?(r(),v("a",{key:2,onClick:e[5]||(e[5]=c=>t.value="password")},"\u5BC6\u7801\u767B\u5F55")):$("",!0),t.value==="password"?(r(),v("a",{key:3,onClick:e[6]||(e[6]=c=>t.value="phone")},"\u624B\u673A\u53F7\u9A8C\u8BC1\u767B\u5F55")):$("",!0)])])])}}});var pe=N(ce,[["__scopeId","data-v-fdc15198"]]);export{pe as default};
